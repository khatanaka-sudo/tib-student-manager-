# TIB学生メンバー管理システム - Googleスプレッドシート連携版

## 📋 セットアップ手順（所要時間: 10分）

### ステップ1: Googleスプレッドシートを作成

1. 新しいGoogleスプレッドシートを作成
2. シート名を以下のように作成（計4シート）：
   - `メンバー`
   - `出席記録`
   - `メンタリング`
   - `ピッチチーム`

3. 各シートに以下の見出し行を設定：

**【メンバー】シート（A1〜H1）**
```
ID | 名前 | よみがな | 大学 | 学年 | 役割 | 関心分野 | メールアドレス | 登録日
```

**【出席記録】シート（A1〜C1）**
```
年月 | メンバーID | 出席
```
※年月は `2026-04` 形式、出席は `TRUE` または `FALSE`

**【メンタリング】シート（A1〜F1）**
```
ID | メンバーID | 日付 | メンター名 | 形式 | メモ
```

**【ピッチチーム】シート（A1〜F1）**
```
ID | チーム名 | 代表者名 | TIB所属 | ステータス | 登録日
```

### ステップ2: Apps Scriptを設定

1. スプレッドシートで「拡張機能」→「Apps Script」を開く
2. `コード.gs` の内容を全て削除
3. 付属の `gas-script.js` ファイルの内容をコピー＆ペースト
4. 「保存」ボタンをクリック（💾アイコン）
5. 「デプロイ」→「新しいデプロイ」をクリック
6. 「種類の選択」→「ウェブアプリ」を選択
7. 設定：
   - **説明**: TIB学生管理システムAPI
   - **次のユーザーとして実行**: 自分
   - **アクセスできるユーザー**: 全員（組織内のみ推奨）
8. 「デプロイ」をクリック
9. **ウェブアプリのURL**をコピー（後で使います）

### ステップ3: HTMLファイルを設定

1. 付属の `tib_manager_sheets.html` をテキストエディタで開く
2. 15行目付近の以下の部分を探す：
```javascript
const SCRIPT_URL = 'ここにGASのURLを貼り付け';
```
3. `'ここに...'` の部分を、ステップ2-9でコピーしたURLに置き換え
4. 保存

### ステップ4: 使用開始

1. `tib_manager_sheets.html` をブラウザで開く
2. 初回アクセス時に権限の承認が必要な場合があります
3. データの追加・編集をすると、自動的にスプレッドシートに反映されます

---

## 🔐 権限管理

スプレッドシートの「共有」設定で、メンバーごとに権限を設定できます：

- **編集者**: データの追加・削除が可能（運営委員補佐用）
- **閲覧者**: データの閲覧のみ（一般メンバー用）
- **コメント可**: 閲覧＋コメント

HTMLファイルは誰でも開けますが、スプレッドシートへのアクセス権限がない人は使えません。

---

## 💡 使い方のコツ

### データのバックアップ
- スプレッドシートなので、自動的にGoogleドライブに保存されます
- 定期的に「ファイル」→「コピーを作成」でバックアップを推奨

### 複数人での同時編集
- 複数人が同時にアクセスしても問題ありません
- データの衝突を避けるため、ページを開いたら「再読み込み」ボタンで最新データを取得

### トラブルシューティング

**Q: データが表示されない**
A: ブラウザのコンソール（F12キー）でエラーを確認してください。GASのURLが正しく設定されているか確認。

**Q: 「権限がありません」エラー**
A: スプレッドシートの共有設定を確認。Apps Scriptのデプロイ設定で「アクセスできるユーザー」が正しいか確認。

**Q: データの反映が遅い**
A: Googleスプレッドシートとの通信に数秒かかることがあります。「再読み込み」ボタンで手動更新も可能。

---

## 📱 モバイル対応

このシステムはスマホ・タブレットでも動作しますが、編集作業はPCでの利用を推奨します。

---

## 🚀 今後の拡張

- メール通知機能（GASのトリガーで実装可能）
- 自動レポート生成（月次サマリー等）
- Slackとの連携

必要に応じてカスタマイズできます！
